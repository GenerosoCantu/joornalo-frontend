{"version":3,"file":"static/webpack/static\\development\\pages\\section\\[section]\\[date]\\[id].js.a2c693023a143bdc4f08.hot-update.js","sources":["webpack:///./pages/section/[section]/[date]/.js"],"sourcesContent":["import { useRouter } from 'next/router'\r\nimport Link from 'next/link';\r\nimport fetch from 'isomorphic-unfetch';\r\nimport Layout from '../../../../components/MyLayout';\r\nimport Router from \"next/router\";\r\nimport redirect from 'next-redirect';\r\nimport Components from \"../../../../components/components.js\";\r\n// import { Responsive, WidthProvider } from \"react-grid-layout\";\r\n\r\n// url ===> http://localhost:3000/section/world/2020-01-11/iraq-iran-us-troops-4c50e545-539e-4893-b505-1edc2de3c977\r\n\r\n\r\n\r\nconst Template = ({ grid, data }) => {\r\n  return grid.rows.map((row, index) => {\r\n    return (\r\n      <div className=\"row\" key={`row-${index}`}>\r\n        {row.column.map((col, index) => {\r\n          return (\r\n            <div className={`col-${col.width}`} key={`col-${index}`}>\r\n              <Components block={col.block} data={data} />\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  });\r\n};\r\n\r\n\r\nconst News = (props) => {\r\n\r\n  const grid = {\r\n    \"rows\": [{\r\n      \"column\": [{\r\n        \"component\": \"foo\",\r\n        \"width\": \"4\",\r\n        \"block\": {\r\n          component: \"foo\",\r\n          text: \"Foo\"\r\n        }\r\n      }, {\r\n        \"component\": \"bar\",\r\n        \"width\": \"4\",\r\n        \"block\": {\r\n          component: \"bar\",\r\n          text: \"Bar\"\r\n        }\r\n      }]\r\n    },\r\n    {\r\n      \"column\": [{\r\n        \"component\": \"boo\",\r\n        \"width\": \"6\",\r\n        \"block\": {\r\n          component: \"boo\",\r\n          text: \"Boo\"\r\n        }\r\n      }, {\r\n        \"component\": \"bar\",\r\n        \"width\": \"6\",\r\n        \"block\": {\r\n          component: \"bar\",\r\n          headline: \"Bar\"\r\n        }\r\n      }]\r\n    }\r\n    ]\r\n  }\r\n\r\n  if (props.notFound) {\r\n    const router = useRouter();\r\n    router.replace('/notfound');\r\n    return;\r\n  }\r\n\r\n  return (\r\n    <Layout>\r\n      <h1>News story</h1>\r\n      <h1>uuid:: {props.uuid}</h1>\r\n      <h1>title:: {props.data.title}</h1>\r\n\r\n      <ul>\r\n        <li>\r\n          <Link href=\"/section/[section]/[date]/[id]\" as=\"/section/world/2020-01-11/iraq-iran-us-troops-4c50e545-539e-4893-b505-1edc2de3c9ZZ\">\r\n            <a>Bad link</a>\r\n          </Link>\r\n        </li>\r\n        <li>\r\n          <Link href=\"/section/[section]/[date]/[id]\" as=\"/section/world/2020-01-11/iraq-iran-us-troops-4c50e545-539e-4893-b505-1edc2de3c977\">\r\n            <a>Good link</a>\r\n          </Link>\r\n        </li>\r\n        <li>\r\n          <Link href=\"/section/[section]/[date]/[id]\" as=\"/section/world/2020-01-11/iraq-iran-us-troops-4c50e545-539e-4893-b505-1edc2de3c988\">\r\n            <a>Good link</a>\r\n          </Link>\r\n        </li>\r\n        <li>\r\n          <Link href=\"/section/[section]/[date]/[id]\" as=\"/section/world-middleeast/2020-01-11/iraq-iran-us-troops-4c50e545-539e-4893-b505-1edc2de3c999\">\r\n            <a>Good link</a>\r\n          </Link>\r\n        </li>\r\n      </ul>\r\n\r\n      <Template grid={props.template} data={props.data} />\r\n\r\n    </Layout>\r\n  )\r\n}\r\n\r\nNews.getInitialProps = async function (context) {\r\n\r\n  const { section, date, id } = context.query;\r\n  const uuid = id.slice(-36);\r\n  const url = `/section/${section}/${date}/${id}`;\r\n  const path = `https://data.joornalo.com/news/${uuid.charAt(0)}/${uuid.charAt(1)}/${uuid}.json`;\r\n\r\n  console.log(uuid);\r\n\r\n  try {\r\n    const res = await fetch(path);\r\n    const data = await res.json();\r\n\r\n    if (url !== data['url']) {\r\n      console.log(`Bad URL...redirected`);\r\n      return redirect(context, data['url'], 308);\r\n    }\r\n\r\n    const templateUrl = `https://data.joornalo.com/templates/news/${data['template']}.json`;\r\n    const res2 = await fetch(templateUrl);\r\n    const template = await res2.json();\r\n\r\n    return {\r\n      uuid,\r\n      data,\r\n      template\r\n    };\r\n\r\n  } catch (e) {\r\n    console.log(`Page not found`);\r\n    return redirect(context, '/notfound', 302);\r\n  }\r\n\r\n};\r\n\r\nexport default News"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AAGA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAGA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAHA;AAQA;AACA;AACA;AACA;AACA;AAFA;AAHA;AARA;AAkBA;AACA;AACA;AACA;AACA;AACA;AAFA;AAHA;AAQA;AACA;AACA;AACA;AACA;AAFA;AAHA;AARA;AAlBA;AACA;AAqCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AACA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AAEA;AAPA;AAAA;AAAA;AACA;AADA;AAUA;AAVA;AAAA;AACA;AADA;AAWA;AACA;AAZA;AAAA;AAAA;AAAA;AACA;AAaA;AAdA;AACA;AADA;AAkBA;AAlBA;AAAA;AACA;AADA;AAmBA;AAnBA;AAAA;AACA;AADA;AAoBA;AApBA;AAuBA;AACA;AACA;AAHA;AACA;AAvBA;AAAA;AAAA;AA6BA;AA7BA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAkCA;;;;A","sourceRoot":""}