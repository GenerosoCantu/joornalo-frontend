{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport store from '../../pages/store';\nimport { GET_NEWS, SET_LOADING, ADD_TEMPLATE, NEWS_ERROR, INIT_AGENT, GET_CONFIG, GET_OTHERNEWS, FRONT_ERROR, GET_FRONT } from '../types';\nimport { initAgent, test } from '../../services/configService';\nimport axios from 'axios';\nimport Parser from 'html-react-parser';\n\nvar getTemplate = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(req, template, agent) {\n    var tmpl, templateUrl, res;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            setLoading();\n            tmpl = agent + '-' + template;\n            templateUrl = \"https://data.joornalo.com/templates/news/\".concat(tmpl, \".json\");\n            console.log(templateUrl);\n            _context.next = 7;\n            return axios.get(templateUrl);\n\n          case 7:\n            res = _context.sent;\n            return _context.abrupt(\"return\", res.data);\n\n          case 11:\n            _context.prev = 11;\n            _context.t0 = _context[\"catch\"](0);\n            console.log('***********Template Error');\n            dispatch({\n              type: NEWS_ERROR,\n              payload: _context.t0.statusText\n            });\n\n          case 15:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[0, 11]]);\n  }));\n\n  return function getTemplate(_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nexport var getOtherNews = function getOtherNews(section) {\n  return /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch, getState) {\n      var moreUrl, res;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              setLoading();\n              moreUrl = \"https://data.joornalo.com/news/\".concat(section, \"-more-news.json\");\n              console.log(moreUrl);\n              _context2.next = 6;\n              return axios.get(moreUrl);\n\n            case 6:\n              res = _context2.sent;\n              dispatch({\n                type: GET_OTHERNEWS,\n                payload: {\n                  topNews: res.data.topNews,\n                  moreNews: res.data.moreNews\n                }\n              });\n              _context2.next = 13;\n              break;\n\n            case 10:\n              _context2.prev = 10;\n              _context2.t0 = _context2[\"catch\"](0);\n              dispatch({\n                type: NEWS_ERROR,\n                payload: 'NotFound'\n              });\n\n            case 13:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 10]]);\n    }));\n\n    return function (_x4, _x5) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n};\nexport var getNews = function getNews(section, date, uuid, url, req) {\n  return /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch, getState) {\n      var path, res, agent, tmpl, template;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.prev = 0;\n              setLoading();\n              path = \"https://data.joornalo.com/news/\".concat(uuid.charAt(0), \"/\").concat(uuid.charAt(1), \"/\").concat(uuid, \".json\");\n              console.log(path);\n              _context3.next = 6;\n              return axios.get(path);\n\n            case 6:\n              res = _context3.sent;\n\n              if (url !== res.data['url']) {\n                dispatch({\n                  type: NEWS_ERROR,\n                  payload: \"Redirect: \".concat(res.data['url'])\n                });\n              }\n\n              agent = getState().news.agent;\n              tmpl = agent + '-' + res.data['template'];\n              template = getState().news.templates[tmpl];\n\n              if (template) {\n                _context3.next = 16;\n                break;\n              }\n\n              _context3.next = 14;\n              return getTemplate(req, res.data['template'], getState().news.agent);\n\n            case 14:\n              template = _context3.sent;\n              dispatch({\n                type: ADD_TEMPLATE,\n                payload: {\n                  template: _defineProperty({}, tmpl, template)\n                }\n              });\n\n            case 16:\n              dispatch({\n                type: GET_NEWS,\n                payload: {\n                  news: res.data,\n                  templateName: 'template-' + res.data['template'],\n                  template: template\n                }\n              });\n              _context3.next = 22;\n              break;\n\n            case 19:\n              _context3.prev = 19;\n              _context3.t0 = _context3[\"catch\"](0);\n              dispatch({\n                type: NEWS_ERROR,\n                payload: 'NotFound'\n              });\n\n            case 22:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[0, 19]]);\n    }));\n\n    return function (_x6, _x7) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n};\nexport var getFront = function getFront(section, req) {\n  return /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch, getState) {\n      var path, res, agent, tmpl, template;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.prev = 0;\n              setLoading();\n              path = \"https://data.joornalo.com/sections/latest/\".concat(section, \".json\");\n              console.log(path);\n              _context4.next = 6;\n              return axios.get(path);\n\n            case 6:\n              res = _context4.sent;\n              // if (url !== res.data['url']) {\n              //   dispatch({\n              //     type: FRONT_ERROR,\n              //     payload: `Redirect: ${res.data['url']}`\n              //   });\n              // }\n              agent = getState().news.agent;\n              tmpl = agent + '-' + res.data['template'];\n              template = getState().news.templates[tmpl];\n\n              if (template) {\n                _context4.next = 15;\n                break;\n              }\n\n              _context4.next = 13;\n              return getTemplate(req, res.data['template'], getState().news.agent);\n\n            case 13:\n              template = _context4.sent;\n              dispatch({\n                type: ADD_TEMPLATE,\n                payload: {\n                  template: _defineProperty({}, tmpl, template)\n                }\n              });\n\n            case 15:\n              //console.log(res.data)\n              dispatch({\n                type: GET_FRONT,\n                payload: {\n                  front: res.data,\n                  templateName: 'template-' + res.data['template'],\n                  template: template\n                }\n              });\n              _context4.next = 23;\n              break;\n\n            case 18:\n              _context4.prev = 18;\n              _context4.t0 = _context4[\"catch\"](0);\n              console.log('FRONT_ERROR--------------------');\n              console.log(_context4.t0);\n              dispatch({\n                type: FRONT_ERROR,\n                payload: 'NotFound'\n              });\n\n            case 23:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, null, [[0, 18]]);\n    }));\n\n    return function (_x8, _x9) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n}; // Set loading to true\n\nexport var setLoading = function setLoading() {\n  return {\n    type: SET_LOADING\n  };\n};\nexport var getConfig = function getConfig(req) {\n  return /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch) {\n      var configUrl, templatesUrl, _yield$Promise$all, _yield$Promise$all2, config, templates, agent;\n\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.prev = 0;\n              configUrl = \"https://data.joornalo.com/config.json\";\n              templatesUrl = \"https://data.joornalo.com/templates/news/templates.json\";\n              console.log(configUrl);\n              console.log(templatesUrl);\n              _context5.next = 7;\n              return Promise.all([axios.get(configUrl), axios.get(templatesUrl), initAgent(req)]);\n\n            case 7:\n              _yield$Promise$all = _context5.sent;\n              _yield$Promise$all2 = _slicedToArray(_yield$Promise$all, 3);\n              config = _yield$Promise$all2[0];\n              templates = _yield$Promise$all2[1];\n              agent = _yield$Promise$all2[2];\n              dispatch({\n                type: GET_CONFIG,\n                payload: {\n                  config: config.data,\n                  templates: templates.data,\n                  agent: agent\n                }\n              });\n              _context5.next = 17;\n              break;\n\n            case 15:\n              _context5.prev = 15;\n              _context5.t0 = _context5[\"catch\"](0);\n\n            case 17:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5, null, [[0, 15]]);\n    }));\n\n    return function (_x10) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n};","map":{"version":3,"sources":["C:/Projects/DEVELOPMENT/joornalo-frontend/front.joornalo.2.23.2021/joornalo-frontend/store/actions/newsActions.js"],"names":["store","GET_NEWS","SET_LOADING","ADD_TEMPLATE","NEWS_ERROR","INIT_AGENT","GET_CONFIG","GET_OTHERNEWS","FRONT_ERROR","GET_FRONT","initAgent","test","axios","Parser","getTemplate","req","template","agent","setLoading","tmpl","templateUrl","console","log","get","res","data","dispatch","type","payload","statusText","getOtherNews","section","getState","moreUrl","topNews","moreNews","getNews","date","uuid","url","path","charAt","news","templates","templateName","getFront","front","getConfig","configUrl","templatesUrl","Promise","all","config"],"mappings":"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","sourcesContent":["import store from '../../pages/store';\r\nimport { GET_NEWS, SET_LOADING, ADD_TEMPLATE, NEWS_ERROR, INIT_AGENT, GET_CONFIG, GET_OTHERNEWS, FRONT_ERROR, GET_FRONT } from '../types';\r\nimport { initAgent, test } from '../../services/configService';\r\nimport axios from 'axios';\r\nimport Parser from 'html-react-parser';\r\n\r\n\r\nconst getTemplate = async (req, template, agent) => {\r\n  try {\r\n    setLoading();\r\n\r\n    const tmpl = agent + '-' + template;\r\n    const templateUrl = `https://data.joornalo.com/templates/news/${tmpl}.json`;\r\n\r\n    console.log(templateUrl)\r\n    const res = await axios.get(templateUrl);\r\n\r\n    return res.data;\r\n\r\n  } catch (err) {\r\n    console.log('***********Template Error');\r\n    dispatch({\r\n      type: NEWS_ERROR,\r\n      payload: err.statusText\r\n    });\r\n  }\r\n\r\n};\r\n\r\nexport const getOtherNews = (section) => async (dispatch, getState) => {\r\n  try {\r\n    setLoading();\r\n\r\n    const moreUrl = `https://data.joornalo.com/news/${section}-more-news.json`;\r\n    console.log(moreUrl);\r\n    const res = await axios.get(moreUrl);\r\n\r\n    dispatch({\r\n      type: GET_OTHERNEWS,\r\n      payload: {\r\n        topNews: res.data.topNews,\r\n        moreNews: res.data.moreNews,\r\n      }\r\n    });\r\n\r\n  } catch (err) {\r\n    dispatch({\r\n      type: NEWS_ERROR,\r\n      payload: 'NotFound'\r\n    });\r\n  }\r\n};\r\n\r\nexport const getNews = (section, date, uuid, url, req) => async (dispatch, getState) => {\r\n  try {\r\n    setLoading();\r\n\r\n    const path = `https://data.joornalo.com/news/${uuid.charAt(0)}/${uuid.charAt(1)}/${uuid}.json`\r\n    console.log(path);\r\n    const res = await axios.get(path);\r\n\r\n    if (url !== res.data['url']) {\r\n      dispatch({\r\n        type: NEWS_ERROR,\r\n        payload: `Redirect: ${res.data['url']}`\r\n      });\r\n    }\r\n\r\n    const agent = getState().news.agent;\r\n    const tmpl = agent + '-' + res.data['template'];\r\n\r\n    let template = getState().news.templates[tmpl];\r\n\r\n    if (!template) {\r\n      template = await getTemplate(req, res.data['template'], getState().news.agent);\r\n      dispatch({\r\n        type: ADD_TEMPLATE,\r\n        payload: {\r\n          template: { [tmpl]: template }\r\n        }\r\n      });\r\n    }\r\n\r\n    dispatch({\r\n      type: GET_NEWS,\r\n      payload: {\r\n        news: res.data,\r\n        templateName: 'template-' + res.data['template'],\r\n        template: template\r\n      }\r\n    });\r\n\r\n  } catch (err) {\r\n    dispatch({\r\n      type: NEWS_ERROR,\r\n      payload: 'NotFound'\r\n    });\r\n  }\r\n};\r\n\r\n\r\nexport const getFront = (section, req) => async (dispatch, getState) => {\r\n  try {\r\n    setLoading();\r\n\r\n    const path = `https://data.joornalo.com/sections/latest/${section}.json`\r\n    console.log(path);\r\n    const res = await axios.get(path);\r\n\r\n    // if (url !== res.data['url']) {\r\n    //   dispatch({\r\n    //     type: FRONT_ERROR,\r\n    //     payload: `Redirect: ${res.data['url']}`\r\n    //   });\r\n    // }\r\n\r\n    const agent = getState().news.agent;\r\n    const tmpl = agent + '-' + res.data['template'];\r\n\r\n    let template = getState().news.templates[tmpl];\r\n\r\n    if (!template) {\r\n      template = await getTemplate(req, res.data['template'], getState().news.agent);\r\n      dispatch({\r\n        type: ADD_TEMPLATE,\r\n        payload: {\r\n          template: { [tmpl]: template }\r\n        }\r\n      });\r\n    }\r\n\r\n    //console.log(res.data)\r\n\r\n    dispatch({\r\n      type: GET_FRONT,\r\n      payload: {\r\n        front: res.data,\r\n        templateName: 'template-' + res.data['template'],\r\n        template: template\r\n      }\r\n    });\r\n\r\n  } catch (err) {\r\n    console.log('FRONT_ERROR--------------------');\r\n    console.log(err);\r\n    dispatch({\r\n      type: FRONT_ERROR,\r\n      payload: 'NotFound'\r\n    });\r\n  }\r\n};\r\n\r\n// Set loading to true\r\nexport const setLoading = () => {\r\n  return {\r\n    type: SET_LOADING\r\n  };\r\n};\r\n\r\n\r\nexport const getConfig = (req) => async dispatch => {\r\n  try {\r\n    const configUrl = `https://data.joornalo.com/config.json`\r\n    const templatesUrl = `https://data.joornalo.com/templates/news/templates.json`;\r\n    console.log(configUrl);\r\n    console.log(templatesUrl);\r\n    const [config, templates, agent] = await Promise.all([\r\n      axios.get(configUrl),\r\n      axios.get(templatesUrl),\r\n      initAgent(req)\r\n    ]);\r\n\r\n    dispatch({\r\n      type: GET_CONFIG,\r\n      payload: {\r\n        config: config.data,\r\n        templates: templates.data,\r\n        agent: agent\r\n      }\r\n    });\r\n\r\n  } catch (err) {\r\n    // dispatch({\r\n    //   type: NEWS_ERROR,\r\n    //   payload: 'NotFound'\r\n    // });\r\n  }\r\n};"]},"metadata":{},"sourceType":"module"}